<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DexScreener API è°ƒè¯•</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .test-item {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
        }
        .success { border-color: #4CAF50; background: #f8fff8; }
        .error { border-color: #f44336; background: #fff8f8; }
        .loading { border-color: #2196F3; background: #f8f9ff; }
        pre {
            background: #f5f5f5;
            padding: 10px;
            border-radius: 5px;
            overflow-x: auto;
            font-size: 12px;
        }
        .icon-test {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 10px 0;
        }
        .icon-test img {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: 1px solid #ddd;
        }
        button {
            background: #2196F3;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #1976D2;
        }
    </style>
</head>
<body>
    <h1>ğŸ” DexScreener API è°ƒè¯•å·¥å…·</h1>
    
    <div class="container">
        <h2>æµ‹è¯•ä»£å¸åœ°å€</h2>
        <button onclick="testToken('0x000ae314e2a2172a039b26378814c252734f556a', 'ASTER')">æµ‹è¯• ASTER</button>
        <button onclick="testToken('0x932fb7f52adbc34ff81b4342b8c036b7b8ac4444', 'DUST')">æµ‹è¯• DUST</button>
        <button onclick="testCustomToken()">æµ‹è¯•è‡ªå®šä¹‰åœ°å€</button>
        <input type="text" id="customAddress" placeholder="è¾“å…¥ä»£å¸åœ°å€" style="margin-left: 10px; padding: 8px;">
    </div>

    <div id="results"></div>

    <script>
        async function testToken(address, name) {
            const resultsDiv = document.getElementById('results');
            const testDiv = document.createElement('div');
            testDiv.className = 'test-item loading';
            testDiv.innerHTML = `
                <h3>ğŸ”„ æµ‹è¯• ${name} (${address})</h3>
                <p>æ­£åœ¨è·å–æ•°æ®...</p>
            `;
            resultsDiv.appendChild(testDiv);

            try {
                console.log(`ğŸ” æµ‹è¯•ä»£å¸: ${name} (${address})`);
                
                // è°ƒç”¨ DexScreener API
                const response = await fetch(`https://api.dexscreener.com/latest/dex/tokens/${address}`);
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }

                const data = await response.json();
                console.log(`âœ… API å“åº”:`, data);

                if (!data.pairs || data.pairs.length === 0) {
                    throw new Error('æ²¡æœ‰æ‰¾åˆ°äº¤æ˜“å¯¹æ•°æ®');
                }

                // æ‰¾åˆ°æœ€ä½³äº¤æ˜“å¯¹
                const bestPair = data.pairs.reduce((best, current) => {
                    const bestLiquidity = parseFloat(best.liquidity?.usd || '0');
                    const currentLiquidity = parseFloat(current.liquidity?.usd || '0');
                    return currentLiquidity > bestLiquidity ? current : best;
                });

                console.log(`ğŸ¯ æœ€ä½³äº¤æ˜“å¯¹:`, bestPair);

                // æå–ä»£å¸ä¿¡æ¯
                const tokenInfo = bestPair.baseToken;
                const imageUrl = bestPair.info?.imageUrl;

                testDiv.className = 'test-item success';
                testDiv.innerHTML = `
                    <h3>âœ… ${name} æµ‹è¯•æˆåŠŸ</h3>
                    <div class="icon-test">
                        <img src="${imageUrl || 'https://via.placeholder.com/40x40/6366f1/ffffff?text=' + (tokenInfo.symbol?.charAt(0) || '?')}" 
                             alt="${tokenInfo.name}" 
                             onload="console.log('âœ… å›¾æ ‡åŠ è½½æˆåŠŸ:', this.src)"
                             onerror="console.log('âŒ å›¾æ ‡åŠ è½½å¤±è´¥:', this.src); this.src='https://via.placeholder.com/40x40/ff6b6b/ffffff?text=X'">
                        <div>
                            <div><strong>åç§°:</strong> ${tokenInfo.name || 'N/A'}</div>
                            <div><strong>ç¬¦å·:</strong> ${tokenInfo.symbol || 'N/A'}</div>
                            <div><strong>åœ°å€:</strong> ${tokenInfo.address || 'N/A'}</div>
                            <div><strong>å›¾æ ‡URL:</strong> ${imageUrl || 'æ— '}</div>
                        </div>
                    </div>
                    <details>
                        <summary>æŸ¥çœ‹å®Œæ•´å“åº”</summary>
                        <pre>${JSON.stringify(data, null, 2)}</pre>
                    </details>
                `;

            } catch (error) {
                console.error(`âŒ æµ‹è¯•å¤±è´¥:`, error);
                testDiv.className = 'test-item error';
                testDiv.innerHTML = `
                    <h3>âŒ ${name} æµ‹è¯•å¤±è´¥</h3>
                    <p><strong>é”™è¯¯:</strong> ${error.message}</p>
                    <p><strong>åœ°å€:</strong> ${address}</p>
                `;
            }
        }

        function testCustomToken() {
            const address = document.getElementById('customAddress').value.trim();
            if (!address) {
                alert('è¯·è¾“å…¥ä»£å¸åœ°å€');
                return;
            }
            testToken(address, 'è‡ªå®šä¹‰ä»£å¸');
        }

        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨æµ‹è¯•
        window.onload = function() {
            console.log('ğŸš€ DexScreener API è°ƒè¯•å·¥å…·å·²åŠ è½½');
        };
    </script>
</body>
</html>
